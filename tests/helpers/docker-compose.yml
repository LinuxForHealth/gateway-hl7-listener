version: "3.2"
services:
    nats-js:
        image: nats:alpine
        ports:
            - "4222:4222"
            # - "6222:6222"
            # - "8222:8222"
        command: --jetstream
        networks:
            - nats-receiver-test
    hl7-listener:
        # Precondition: Referenced image exists (pulled from artifactory or created from project--see README).
        image: whpa-cdp-hl7-listener-service:1.0.0
        environment:
            WHPA_CDP_CLIENT_GATEWAY_HL7_MLLP_HOST: hl7-listener
            WHPA_CDP_CLIENT_GATEWAY_HL7_MLLP_PORT: 2575
            WHPA_CDP_CLIENT_GATEWAY_MESSAGES: HL7.MESSAGES
            WHPA_CDP_CLIENT_GATEWAY_NATS_SERVER_URL: nats-js:4222
            WHPA_CDP_CLIENT_GATEWAY_TIMEZONE: America/New_York
            WHPA_CDP_CLIENT_GATEWAY_TENANT: cloud1
        depends_on:
            - nats-js
        ports:
            - "2575:2575"
        networks:
            - nats-receiver-test

networks:
    nats-receiver-test:
        name: nats-receiver-test
